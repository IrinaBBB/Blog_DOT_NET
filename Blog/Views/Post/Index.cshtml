@model Blog.Entities.Post


<h1>@Model.Title</h1>
<div>@Model.Body</div>


<h2>Comments:</h2>
<a class="btn btn-primary" asp-controller="Comment" asp-action="Create" asp-route-id="@Model.Id">Create new comment</a>
@if (Model.Comments != null)
{
    @foreach (var comment in Model.Comments)
    {
        <div class="text-secondary">
            @await UserManager.FindByIdAsync(comment.OwnerId.ToString())
        </div>
        <div>@comment.Text</div>
        <div>@comment.Created.ToString("MM/dd/yyyy H:mm")</div>
        <div class="d-flex" style="text-align: right;">
        @if ((await AuthorizationService.AuthorizeAsync(
            User, comment,
            ItemOperations.Update)).Succeeded)
        {
            <a asp-controller="Comment" asp-action="Edit" asp-route-id="@comment.Id" class="btn btn-warning">
                <i class="fas fa-edit"></i>
            </a>
        }
        @if ((await AuthorizationService.AuthorizeAsync(
            User, comment,
            ItemOperations.Delete)).Succeeded)
        {
            <a asp-controller="Comment" asp-action="Delete" asp-route-commentId="@comment.Id" asp-route-postId="@Model.Id" class="btn btn-danger">
                <i class="fas fa-trash-alt"></i>
            </a>
            }
        </div>
        <hr/>
    }
}
else
{
    <div>There is no comments for this post yet</div>
}

